<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Đồ án thiết kế web</title>

    <!-- Sử dụng Bootstrap framework -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"
        integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
</head>

<body>
    <!-- Navigation bar -->
    <header class="d-flex flex-wrap justify-content-center py-3 mb-4 border-bottom">
        <a class="d-flex align-items-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none" href="/">
            <span class="px-4 fw-bold fs-4">Đồ án thiết kế web</span>
        </a>
        <ul class="nav nav-pills">
            <li class="nav-item">
                <a class="nav-link active" href="#">Trang chủ</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">Đăng ký môn học</a>
            </li>
        </ul>
    </header>

    <!-- Danh sách các môn học -->
    <main>
        <div class="container">
            <div class="album bg-body-tertiary py-5">
                <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3" id="courses-album">
                </div>
            </div>
        </div>
    </main>

    <!-- Sử dụng jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"
        integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>

    <!-- Sử dụng Bootstrap framework -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>

    <!-- Main script -->
    <script>
        class Course {
            constructor(id, name, videoId) {
                this.id = id;
                this.name = name;
                this.videoId = videoId;
            }

            static fromJson(jsonObj) {
                return new Course(jsonObj["id"], jsonObj["name"], jsonObj["video-id"]);
            }

            get videoEmbedUrl() {
                return `https://www.youtube.com/embed/${this.videoId}`;
            }

            get videoThumbnailUrl() {
                return `https://img.youtube.com/vi/${this.videoId}/0.jpg`;
            }

            toHtmlCard() {
                // <div class="col">
                //     <div class="card shadow-sm">
                //         <img class="bd-placeholder-img card-img-top" src="<videoThumbnailUrl>" alt="<name>">
                //         <div class="card-body">
                //             <p class="card-text"></p>
                //         </div>
                //     </div>
                // </div>
                return $("<div></div>", { class: "col" }).append(
                    $("<div></div>", { class: "card shadow-sm" }).append(
                        $("<img>", { class: "bd-placeholder-img card-img-top", src: this.videoThumbnailUrl, alt: this.name }),
                        $("<div></div>", { class: "card-body" }).append(
                            $("<h5></h5>", { class: "card-title" }).html(this.name),
                        ),
                    ),
                );
            }
        }

        async function fetchAllCourses(baseUrl) {
            try {
                const jsonData = await $.getJSON(new URL("courses", baseUrl));
                return jsonData.map(e => Course.fromJson(e));
            }
            catch (err) {
                return [];
            }
        }

        $(async () => {
            // ==========================================================
            // Load tất cả các khoá học và thêm vào HTML DOM
            // ==========================================================

            const coursesAlbum = $("#courses-album");

            const coursesList = await fetchAllCourses("https://64662fa7228bd07b355e4d69.mockapi.io");
            coursesList.forEach(course => {
                coursesAlbum.append(course.toHtmlCard());
            });
        });
    </script>
</body>

</html>
